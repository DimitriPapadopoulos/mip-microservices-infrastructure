---

airflow_python_path: '/usr/local/lib/python3.5/dist-packages/'

# We assume that MRI database is deployed under the same Postgres instance as airflow database
# Identifier must be under /data-factory/airflow namespace to be able to use dependencies on scheduler and webserver
airflow_db_marathon_id: '/data-factory/airflow/airflow-db'

airflow_scheduler_marathon_id: '/data-factory/airflow/scheduler'
airflow_scheduler_marathon_dependencies:
  - "{{ airflow_db_marathon_id }}"

airflow_webserver_marathon_id: '/data-factory/airflow/webserver'
airflow_webserver_marathon_dependencies:
  - "{{ airflow_db_marathon_id }}"
  - "{{ airflow_scheduler_marathon_id }}"

# TODO airflow_executor: 'MesosExecutor'

airflow_db_deb_packages:
  - python3-pip
  - python3-psycopg2
  - curl

mri_db_deb_packages:
  - python3-pip
  - python3-psycopg2
  - curl

airflow_deb_packages:
  - netcat
  - curl
  - python3-pip
  - python3-dev
  - libffi-dev
  - build-essential
  - locales
  - libffi-dev
  - libssl-dev

airflow_pip_packages:
  - "pytz==2015.7"
  - pyOpenSSL
  - ndg-httpsclient
  - pyasn1
  - pydicom
  - alembic

airflow_plugins:
  - name: mesos
    required_debs: []
    required_pips: []
  - name: postgresql
    required_debs:
      - postgresql-client
      - python3-psycopg2
    required_pips: []
  - name: crypto
    required_debs:
      - libssl-dev
    required_pips:
      - cryptography
  - name: ldap
    required_debs:
      - libkrb5-dev
      - libsasl2-dev
    required_pips: []

airflow_scripts:
  - url: https://github.com/HBPSp8Repo/mri-preprocessing-pipeline.git
    # Need to use the SHA hash to let Ansible be able to check the PGP signature of the commit
    version: 7304142b36c81c64864779bae9abe77440c1cea5
    verify_commit: true
    dest: '{{ airflow_scripts_root }}/mri-preprocessing-pipeline'
  - url: https://github.com/HBPSp8Repo/airflow-imaging-plugins.git
    version: master
    # TODO set to true
    verify_commit: false
    dest: '{{ airflow_scripts_root }}/airflow-imaging-plugins'
  - url: https://github.com/HBPSp8Repo/airflow-mri-preprocessing-dags.git
    version: master
    # TODO set to true
    verify_commit: false
    dest: '{{ airflow_scripts_root }}/airflow-mri-preprocessing-dags'
