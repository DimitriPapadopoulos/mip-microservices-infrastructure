---

# The user to run nginx
nginx_user: "www-data"

# A list of directives for the events section.
nginx_events_params:
  - worker_connections 512

# A list of hashs that define the servers for nginx,
# as with http parameters. Any valid server parameters
# can be defined here.
nginx_http_params:
  - sendfile on
  - access_log /var/log/nginx/access.log

nginx_sites:
  default:
    - |
      listen 80;
      server_name _;
      root "/var/www/html";
      index index.html;
      location /mesos/ {
      	  rewrite             ^/mesos(/.*) $1 break;
          proxy_set_header    Host $host;
          proxy_set_header    X-Real-IP $remote_addr;
          proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header    X-Forwarded-Proto $scheme;
          proxy_set_header    X-NginX-Proxy true;
          proxy_pass          {{ internal_mesos_url }};
          proxy_read_timeout  90;
          proxy_redirect      {{ internal_mesos_url }} /mesos/;
      }
      location /marathon/ {
      	  rewrite             ^/marathon(/.*) $1 break;
          proxy_set_header    Host $host;
          proxy_set_header    X-Real-IP $remote_addr;
          proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header    X-Forwarded-Proto $scheme;
          proxy_set_header    X-NginX-Proxy true;
          proxy_pass          {{ internal_marathon_url }};
          proxy_read_timeout  90;
          proxy_redirect      {{ internal_marathon_url }} /marathon/;
      }
      location /chronos/ {
      	  rewrite             ^/chronos(/.*) $1 break;
          proxy_set_header    Host $host;
          proxy_set_header    X-Real-IP $remote_addr;
          proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header    X-Forwarded-Proto $scheme;
          proxy_set_header    X-NginX-Proxy true;
          proxy_pass          {{ internal_chronos_url }};
          proxy_read_timeout  90;
          proxy_redirect      {{ internal_chronos_url }} /chronos/;
      }
      location /workflow/ {
          rewrite             ^/workflow(/.*) $1 break;
          proxy_set_header    Host $host;
          proxy_set_header    X-Real-IP $remote_addr;
          proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header    X-Forwarded-Proto $scheme;
          proxy_set_header    X-NginX-Proxy true;
          proxy_pass          {{ internal_workflow_url }};
          proxy_read_timeout  90;
          proxy_redirect      {{ internal_workflow_url }} /workflow/;
      }

# A list of hashs that define additional configuration
nginx_configs:
  gzip:
      - gzip on
      - gzip_disable msie6
